<!DOCTYPE html>
<html lang="en">
    <head> 
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<!-- Website Font style  <link rel="stylesheet" href="../cssjs/register/register.css">-->
	    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
		
		<!-- Google Fonts -->
		<link href='https://fonts.googleapis.com/css?family=Passion+One' rel='stylesheet' type='text/css'>
        <link href='https://fonts.googleapis.com/css?family=Oxygen' rel='stylesheet' type='text/css'>
        
        <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
		<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <script src="//code.jquery.com/jquery-1.11.1.min.js"></script>

		<title>Admin</title>

		<script type = "text/javaScript">

			function get_user(){
			// 1. 데이터 입력하기 : name, email, username, password, confirm password
			let K_name = $('#k_name').val();
			let E_name = $('#e_name').val();
			let Email = $('#email').val();
			let Username = $('#username').val();
			let Password = $('#password').val();
			let Confirmpassword = $('#confirmpassword').val();
			let Role = $('#role').val();

			// 2. 입력사항 검사하기
				// 2.1 해당 요소 중 하나라도 입력하지 않았을 경우 alert를 띄운다
				
				if ( E_name === '') {
					alert('Please Enter Your E_Name');
					$('#e_name').focus();
					return ;
				} 
				if ( Email === '') {
					alert('Please Enter Your Email');
					$('#email').focus();
					return ;
				} 
				if ( Username === '') {
					alert('Please Enter Your Username');
					$('#username').focus();
					return ;
				} 
				if ( Password === ''){
					alert("Please Enter Your Password");
					$('#password').focus();
					return ;
				} 
				if ( Confirmpassword === ''){
					alert("Please Enter Your ConfirmPassword");
					$('#confirmPassword').focus();
					return ;
				}
				if ( Role === ''){
					alert("Please Enter Your Role");
					$('#role').focus();
					return ;
				}
			// 입력 영어이름을 대문자로 바꾸기 
			E_name = E_name.toUpperCase();
			// Role을 Number 형태로 바꾸기
			Role = Number(Role)
			

			// 2.2 입력내용을 검사한다 
				// 1) English Name의 길이를 검사한다
				if( E_name.length < 1 || E_name.length > 50){
					alert("Name should be written in 1 ~ 50 words")
				}
				// 2) Password 를 검사한다 
				check(Password)
			// 3. POST에 저장을 요청한다 
			$.ajax({
				type: "POST",
				url: '/api/users/register',
				// name, email, username, password 정보 넘겨주기 
				data: { 
					k_name : K_name, 
					e_name : E_name, 
					email : Email, 
					password : Password, 
					username : Username , 
					role: Role,
				} ,
				// 성공시
				success : function(response){
					// console.log('res',response['success'] )
					if( response['success'] === 'true' ){
						alert('Registration Success')
					// 로그인 페이지로 이동시키기
						window.location.href = "http://localhost:4000/api/users/login"
					}else {
						alert('Same username already Exist')
						$('#username').focus();
					}
				}
        	})
		} // function get_user

		// 비밀번호 체크 함수
		function check(password){
			if(!/^[a-zA-Z0-9]{7,15}$/.test(password)){
				alert('7 ~ 15words by combination of number and english');
				return ;
			}
			var checkNumber = password.search(/[0-9]/g);
			var checkEnglish = password.search(/[a-z]/ig);

			if(checkNumber <0 || checkEnglish <0){
				alert("combine number and english");
				return ;
			}

			if(/(\w)\1\1\1/.test(password)){
				alert('Cannot use word like 444 more than 4 times');
				return ;
			}
				return true;
		}


		</script>
	</head>
	<body>
		<div class="container">
			<div class="row main">
				<div class="main-login main-center">
				<h1>Register and Enjoy Our Service</h1>
					<div class="register" >
						<div class="form-group">
							<label for="name" class="cols-sm-2 control-label">Your Korean Name</label>
							<div class="cols-sm-10">
								<div class="input-group">
									<span class="input-group-addon"><i class="fa fa-user fa" aria-hidden="true"></i></span>
									<input type="text" class="form-control" name="k_name" id="k_name"  placeholder="Enter your Korean Name If not, Skip "/>
								</div>
							</div>
						</div>

						<div class="form-group">
							<label for="name" class="cols-sm-2 control-label">Your English Name( 1 ~ 50 words , Use UPPERCASE)</label>
							<div class="cols-sm-10">
								<div class="input-group">
									<span class="input-group-addon"><i class="fa fa-user fa" aria-hidden="true"></i></span>
									<input type="text" class="form-control" name="e_name" id="e_name"  placeholder="Enter your English Name"/>
								</div>
							</div>
						</div>

						<div class="form-group">
							<label for="email" class="cols-sm-2 control-label">Your Email</label>
							<div class="cols-sm-10">
								<div class="input-group">
									<span class="input-group-addon"><i class="fa fa-envelope fa" aria-hidden="true"></i></span>
									<input type="text" class="form-control" name="email" id="email"  placeholder="Enter your Email"/>
								</div>
							</div>
						</div>


						<div class="form-group">
							<label for="username" class="cols-sm-2 control-label">Username</label>
							<div class="cols-sm-10">
								<div class="input-group">
									<span class="input-group-addon"><i class="fa fa-users fa" aria-hidden="true"></i></span>
									<input type="text" class="form-control" name="username" id="username"  placeholder="Enter your Username"/>
								</div>
							</div>
						</div>

						<div class="form-group">
							<label for="password" class="cols-sm-2 control-label">Password  (  7 ~ 15 words by the combination of number and English  )</label>
							<div class="cols-sm-10">
								<div class="input-group">
									<span class="input-group-addon"><i class="fa fa-lock fa-lg" aria-hidden="true"></i></span>
									<input type="password" class="form-control" name="password" id="password"  placeholder="Enter your Password"/>
								</div>
							</div>
						</div>

						<div class="form-group">
							<label for="confirm" class="cols-sm-2 control-label">Confirm Password</label>
							<div class="cols-sm-10">
								<div class="input-group">
									<span class="input-group-addon"><i class="fa fa-lock fa-lg" aria-hidden="true"></i></span>
									<input type="password" class="form-control" name="confirm" id="confirm"  placeholder="Confirm your Password"/>
								</div>
							</div>
						</div>
						<div class="form-group">
							<label for="role" class="cols-sm-2 control-label">Role</label>
							<div class="cols-sm-10">
								<div class="input-group">
									<span class="input-group-addon"><i class="far fa-play-circle" aria-hidden="true"></i></span>
									<select class="form-control" name="role" id="role">
										<option value='' selected>Choose Your Role</option>
										<option value = '1' >User</option>
										<option value = '0' >Dancer</option>
									</select>
								</div>
							</div>
						</div>

						<div class="form-group ">
							<input onclick="get_user()" type="submit" value="Submit" id="button" class="btn btn-primary btn-lg btn-block login-button" />
						</div>

						
					</div>
				</div>
			</div>
		</div>

		 <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
	</body>
</html>